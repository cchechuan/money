<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘è¦å‡ºåƒ¹</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <style>
        body { font-family: sans-serif; background: #f0f2f5; padding: 15px; text-align: center; }
        .card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); max-width: 400px; margin: auto; }
        h2 { color: #333; margin-bottom: 10px; }
        input { width: 100%; padding: 15px; font-size: 18px; border: 2px solid #ddd; border-radius: 10px; box-sizing: border-box; margin-bottom: 20px; text-align: center; }
        
        .section-label { font-size: 14px; color: #7f8c8d; margin-bottom: 10px; text-align: left; }
        
        /* å–Šåƒ¹æŒ‰éˆ• (å¤§) */
        .b-call { width: 100%; padding: 25px; font-size: 24px; background: #3498db; color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; margin-bottom: 20px; box-shadow: 0 4px #2980b9; }
        .b-call:active { box-shadow: 0 2px #2980b9; transform: translateY(2px); }

        /* å¿«é€Ÿå‡ºåƒ¹æ ¼ç‹€æ’åˆ— */
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        button { padding: 15px; font-size: 18px; border: none; border-radius: 10px; color: white; cursor: pointer; transition: 0.2s; }
        .b-add { background: #27ae60; }
        .b-add:active { background: #219150; }
        
        /* æ£„æ¨™æŒ‰éˆ• */
        .b-quit { background: #95a5a6; grid-column: span 2; margin-top: 10px; font-size: 16px; }
        .b-quit:hover { background: #7f8c8d; }

        #msg { margin-top: 15px; font-weight: bold; min-height: 24px; }
    </style>
</head>
<body>

<div class="card">
    <h2>è«‹è¼¸å…¥æ‚¨çš„å§“å</h2>
    <input type="text" id="userName" placeholder="ä¾‹å¦‚ï¼šç‹å°æ˜">
    
    <div id="actions">
        <div class="section-label">å³æ™‚å‡ºåƒ¹</div>
        <button class="b-call" onclick="bid(1)">å–Šåƒ¹ (+1)</button>

        <div class="section-label">å¿«é€ŸåŠ ç¢¼</div>
        <div class="grid">
            <button class="b-add" onclick="bid(1)">è¿½åŠ  $1</button>
            <button class="b-add" onclick="bid(5)">è¿½åŠ  $5</button>
            <button class="b-add" onclick="bid(10)">è¿½åŠ  $10</button>
            <button class="b-add" onclick="bid(50)">è¿½åŠ  $50</button>
            <button class="b-add" onclick="bid(100)" style="grid-column: span 2;">è¿½åŠ  $100</button>
            <button class="b-quit" onclick="quitBid()">âŒ æˆ‘è¦æ£„æ¨™</button>
        </div>
    </div>
    <div id="msg"></div>
</div>

<script>
    // æ‚¨çš„ Firebase è¨­å®š
    const firebaseConfig = {
        apiKey: "AIzaSyBLKKHyGT1MHJqMq8q8tjJTBNTaIc7EKBs",
        authDomain: "money0115.firebaseapp.com",
        databaseURL: "https://money0115-default-rtdb.firebaseio.com",
        projectId: "money0115",
        storageBucket: "money0115.firebasestorage.app",
        messagingSenderId: "486161681478",
        appId: "1:486161681478:web:ea1107c2c5c8ebe6a5ce47",
        measurementId: "G-WT1BGS47KH"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database().ref('auction_live');

    // å‡ºåƒ¹é‚è¼¯
    function bid(amt) {
        const name = document.getElementById('userName').value.trim();
        if (!name) {
            alert("è«‹å…ˆè¼¸å…¥å§“åå†å‡ºåƒ¹ï¼");
            return;
        }
        db.child('bids').child(name).transaction(curr => (curr || 0) + amt);
        showMsg("æˆåŠŸå‡ºåƒ¹ +$" + amt, "#27ae60");
    }

    // æ£„æ¨™é‚è¼¯
    function quitBid() {
        const name = document.getElementById('userName').value.trim();
        if (!name) return alert("è«‹è¼¸å…¥å§“åä»¥å®šä½æ‚¨çš„è³‡æ–™");
        if (confirm("ç¢ºå®šè¦æ£„æ¨™å—ï¼Ÿæ‚¨çš„å‡ºåƒ¹ç´€éŒ„å°‡è¢«æ¸…é™¤ã€‚")) {
            db.child('bids').child(name).remove();
            showMsg("å·²å–æ¶ˆæ‚¨çš„ç«¶æ¨™è³‡æ ¼", "#e74c3c");
        }
    }

    // é¡¯ç¤ºè¨Šæ¯
    function showMsg(t, color) {
        const m = document.getElementById('msg');
        m.innerText = t; m.style.color = color;
        setTimeout(() => m.innerText = "", 2000);
    }

    // ç›£è½å¾Œå°ç‹€æ…‹ (å¦‚æœç®¡ç†å“¡æ±ºæ¨™ï¼Œå°±åœç”¨æŒ‰éˆ•)
    db.child('status').on('value', (s) => {
        if (s.val() === 'closed') {
            document.getElementById('actions').style.display = 'none';
            document.getElementById('msg').innerText = "ğŸ”´ ç«¶æ¨™å·²çµæŸï¼Œè¬è¬åƒèˆ‡ï¼";
            document.getElementById('msg').style.color = "red";
        } else {
            document.getElementById('actions').style.display = 'block';
        }
    });
</script>
</body>
</html>